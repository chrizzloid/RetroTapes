@page
@model RetroTapes.Pages.Addresses.IndexModel
@{
    ViewData["Title"] = "Adresser";
}

<div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h3 mb-0">Adresser</h1>
    <a asp-page="Create" class="btn btn-primary">Ny adress</a>
</div>

<form method="get" class="card card-body mb-3">
    <div class="row g-2">
        <div class="col-md-4">
            <input class="form-control" type="search" name="q" value="@Model.q" placeholder="Sök gata eller stad" />
        </div>
        <div class="col-md-2 d-grid">
            <button class="btn btn-outline-secondary" type="submit">Filtrera</button>
        </div>
    </div>
</form>

@if (!Model.Result.Items.Any())
{
    <div class="alert alert-light border">
        Inga adresser matchar din filtrering. <a asp-page="Create">Skapa den första?</a>
    </div>
}
else
{
    <div class="table-responsive">
        <table class="table table-hover align-middle">
            <thead class="table-light sticky-top">
                <tr>
                    <th>
                        <a asp-page="./Index"
                           asp-route-q="@Model.q"
                           asp-route-sort="title"
                           asp-route-pageIndex="@Model.pageIndex"
                           asp-route-pageSize="@Model.pageSize"
                           class="text-decoration-none">Gata</a>
                        <span class="text-muted">/</span>
                        <a asp-page="./Index"
                           asp-route-q="@Model.q"
                           asp-route-sort="street_desc"
                           asp-route-pageIndex="@Model.pageIndex"
                           asp-route-pageSize="@Model.pageSize"
                           class="text-decoration-none">▼</a>
                    </th>
                    <th>Stad</th>
                    <th>Postnummer</th>
                    <th>Land</th>                     
                    <th class="text-end">Åtgärder</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var f in Model.Result.Items)
                {
                    <tr>
                        <td>@f.Address</td>
                        <td>@f.City</td>
                        <td>@f.PostalCode</td>
                        <td>@f.Country</td>
                        <td class="text-end">
                            <a asp-page="Details" asp-route-id="@f.AddressId" class="btn btn-sm btn-outline-secondary">Visa</a>
                            <a asp-page="Edit" asp-route-id="@f.AddressId" class="btn btn-sm btn-outline-primary">Redigera</a>
                            <a asp-page="Delete" asp-route-id="@f.AddressId" class="btn btn-sm btn-outline-danger"
                               onclick="return confirm('Vill du ta bort adressen?');">Ta bort</a>

                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <nav class="d-flex justify-content-between align-items-center">
        <div class="text-muted">
            Sida @Model.Result.Page av @Model.Result.TotalPages (@Model.Result.TotalCount poster)
        </div>
        <ul class="pagination mb-0">
            @for (var i = 1; i <= Model.Result.TotalPages; i++)
            {
                <li class="page-item @(i == Model.Result.Page ? "active" : "")">
                    <a class="page-link" asp-page="./Index"
                       asp-route-q="@Model.q"
                       asp-route-sort="@Model.sort"
                       asp-route-pageIndex="@i"
                       asp-route-pageSize="@Model.pageSize">@i</a>
                </li>

            }
        </ul>
    </nav>
}
